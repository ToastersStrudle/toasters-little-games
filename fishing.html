<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>3D Fishing Prototype</title>
<style>
body,html{margin:0;overflow:hidden;height:100%;background:#87ceeb}
#ui{position:absolute;top:10px;left:10px;color:#fff;font-family:sans-serif;z-index:1}
#ui div{margin-bottom:5px}
canvas{display:block}
</style>
</head>
<body>
<div id="ui">
  <div id="msg"></div>
  <div>Fish: <span id="bag">0</span></div>
  <div>Coins: <span id="coins">0</span></div>
</div>
<script src="https://unpkg.com/three@0.142.0/build/three.min.js"></script>
<script src="https://unpkg.com/three@0.142.0/examples/js/controls/PointerLockControls.js"></script>
<script>
let scene=new THREE.Scene(),camera=new THREE.PerspectiveCamera(75,innerWidth/innerHeight,0.1,1000),renderer=new THREE.WebGLRenderer({antialias:1});
renderer.setSize(innerWidth,innerHeight);document.body.appendChild(renderer.domElement);
let controls=new THREE.PointerLockControls(camera,renderer.domElement);
document.body.addEventListener("click",()=>controls.lock());
scene.add(controls.getObject());
camera.position.set(0,2,5);
let light=new THREE.DirectionalLight(0xffffff,1);light.position.set(5,10,7);scene.add(light);
let ground=new THREE.Mesh(new THREE.PlaneGeometry(500,500),new THREE.MeshLambertMaterial({color:0x228B22}));
ground.rotation.x=-Math.PI/2;scene.add(ground);
let water=new THREE.Mesh(new THREE.PlaneGeometry(200,200,32,32),new THREE.MeshLambertMaterial({color:0x1e90ff,transparent:1,opacity:0.6}));
water.rotation.x=-Math.PI/2;water.position.y=0.1;scene.add(water);
let raycaster=new THREE.Raycaster(),mouse=new THREE.Vector2(),state="idle",bobber,fishMesh;
let fishCount=0,coins=0;
const bagEl=document.getElementById("bag"),coinsEl=document.getElementById("coins"),msgEl=document.getElementById("msg");
const fishTypes=[["Minnow",2,0xffff00],["Bass",10,0xff0000],["Salmon",25,0xff8000],["Koi",80,0xffffff]];
function show(t){msgEl.textContent=t;setTimeout(()=>msgEl.textContent="",1500)}
function cast(){
  raycaster.setFromCamera({x:0,y:0},{camera});
  let i=raycaster.intersectObject(water);
  if(!i.length) return;
  bobber=new THREE.Mesh(new THREE.SphereGeometry(0.2),new THREE.MeshLambertMaterial({color:0xff0000}));
  bobber.position.copy(i[0].point).setY(0.5);
  scene.add(bobber);state="waiting";show("Cast!");
  setTimeout(()=>{state="bite";show("Hooked! Click to reel")},2000+Math.random()*3000);
}
let anims=[];
function reel(){
  if(!bobber) return;
  let f=fishTypes[Math.floor(Math.pow(Math.random(),1.5)*fishTypes.length)];
  fishMesh=new THREE.Mesh(new THREE.SphereGeometry(0.3),new THREE.MeshLambertMaterial({color:f[2]}));
  fishMesh.position.copy(bobber.position);
  scene.add(fishMesh);
  scene.remove(bobber);bobber=null;
  anims.push({m:fishMesh,target:new THREE.Vector3().copy(camera.position),v:f});
  state="idle";show("Reeling...");
}
window.addEventListener("mousedown",()=>{if(state==="idle")cast();else if(state==="bite")reel()});
window.addEventListener("keydown",e=>{if(e.key==="e"&&controls.getObject().position.distanceTo(new THREE.Vector3(0,2,0))<3){
  if(!fishCount) return show("No fish");
  coins+=fishCount*5;
  fishCount=0;bagEl.textContent=fishCount;coinsEl.textContent=coins;show("Sold all");
}});
function animate(){
  requestAnimationFrame(animate);
  let dt=0.05;
  for(let a of anims){
    a.m.position.lerp(a.target,dt);
    if(a.m.position.distanceTo(a.target)<0.5){
      scene.remove(a.m);
      fishCount++;bagEl.textContent=fishCount;
      anims=anims.filter(x=>x!==a);
    }
  }
  renderer.render(scene,camera);
}
animate();
</script>
</body>
</html>
